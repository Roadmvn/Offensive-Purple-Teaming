# Solution - Windows Recon Beginner Lab

## Étape 1 : Découverte Active Directory

```cmd
REM Identification des contrôleurs de domaine
nslookup -type=SRV _ldap._tcp.dc._msdcs.CORP.LOCAL
nltest /dclist:CORP.LOCAL

REM Énumération des ordinateurs du domaine
net view /domain:CORP.LOCAL
for /f "skip=1 tokens=1" %i in ('net view /domain:CORP.LOCAL') do @echo %i

REM Relations de confiance
nltest /domain_trusts
nltest /trusted_domains

REM Rôles FSMO
netdom query fsmo
```

**Résultats attendus :**
- DC1.CORP.LOCAL (192.168.1.10) - PDC Emulator, RID Master
- DC2.CORP.LOCAL (192.168.1.11) - Infrastructure Master
- 45 ordinateurs membres découverts

## Étape 2 : Énumération des services

```cmd
REM Test des partages SMB
for /L %i in (1,1,254) do @(net view \\192.168.1.%i 2>nul && echo 192.168.1.%i has shares)

REM Test RDP
nmap -p 3389 --script rdp-enum-encryption 192.168.1.0/24

REM Partages administratifs
net view \\192.168.1.10
net use \\192.168.1.10\C$ "" /user:""
```

## Étape 3 : Détection de vulnérabilités

```cmd
REM Vulnérabilités SMB avec Nmap
nmap --script smb-vuln-ms17-010,smb-vuln-ms08-067 -p 445 192.168.1.0/24

REM Versions Windows
nmap --script smb-os-discovery -p 445 192.168.1.0/24
```

**Vulnérabilités identifiées :**
- 3 systèmes vulnérables à EternalBlue (MS17-010)
- 5 partages avec permissions "Everyone"
- 2 serveurs RDP sans chiffrement NLA
- 8 systèmes Windows 7 non patchés

