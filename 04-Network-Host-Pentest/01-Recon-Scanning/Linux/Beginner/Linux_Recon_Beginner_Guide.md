# Linux Recon-Scanning – Beginner

La reconnaissance réseau sous Linux constitue la première étape cruciale de tout test d'intrusion. Ce guide présente les techniques fondamentales de découverte d'hôtes et de ports en utilisant des outils natifs et accessibles, permettant aux débutants de maîtriser les bases de l'énumération réseau tout en développant une approche méthodique et discrète.

## Table of Contents
1. Concepts clés
2. Outils & Commandes
3. Méthode pas-à-pas
4. OPSEC Tips
5. Lab-Challenge
6. Going Further

---



### 1 • Concepts clés

#### 1.1 Objectifs du scan de reconnaissance

La reconnaissance réseau vise à identifier les systèmes actifs, les services en cours d'exécution et les vulnérabilités potentielles dans un environnement cible. Pour un débutant, l'objectif principal est de comprendre la topologie réseau et de découvrir les points d'entrée possibles sans déclencher d'alertes de sécurité. Cette phase préliminaire permet de cartographier l'infrastructure avant d'approfondir l'analyse des services spécifiques.

Les informations collectées incluent les adresses IP actives, les ports ouverts, les versions de services et les systèmes d'exploitation. Cette approche méthodique évite les tentatives d'intrusion aveugles et optimise les phases ultérieures du test de pénétration.

#### 1.2 Différence entre scan passif et actif

Le scan passif consiste à collecter des informations sans envoyer de paquets directement vers les cibles. Il s'appuie sur l'écoute du trafic réseau, l'analyse des tables ARP locales et la consultation de sources d'information publiques. Cette méthode présente l'avantage d'être indétectable mais limite les informations disponibles.

Le scan actif implique l'envoi de paquets vers les systèmes cibles pour provoquer des réponses révélatrices. Bien que plus informatif, il génère des traces dans les logs et peut déclencher des systèmes de détection d'intrusion. Pour un débutant, il est essentiel de comprendre cette distinction pour adapter sa stratégie selon le contexte de l'engagement.

#### 1.3 Ports les plus courants vs scan complet

Les 1000 ports les plus courants représentent environ 95% des services accessibles sur un système typique. Cette approche permet un scan rapide et efficace, particulièrement adaptée aux débutants qui découvrent les services standards (HTTP/80, HTTPS/443, SSH/22, FTP/21, Telnet/23, SMTP/25, DNS/53, etc.).

Un scan complet des 65535 ports TCP et UDP fournit une couverture exhaustive mais nécessite considérablement plus de temps et génère davantage de bruit réseau. Pour débuter, la stratégie recommandée consiste à effectuer d'abord un scan des ports courants, puis d'approfondir avec un scan complet uniquement sur les cibles prometteuses.

#### 1.4 Protocoles TCP vs UDP

Le protocole TCP (Transmission Control Protocol) établit une connexion fiable avec accusé de réception, facilitant la détection des ports ouverts grâce au handshake à trois voies (SYN, SYN-ACK, ACK). Les scans TCP sont plus fiables et plus faciles à interpréter pour les débutants, car les réponses sont prévisibles.

Le protocole UDP (User Datagram Protocol) fonctionne sans connexion et sans garantie de livraison, rendant la détection des ports ouverts plus complexe. L'absence de réponse peut indiquer un port fermé, filtré ou ouvert mais silencieux. Les services UDP critiques incluent DNS (53), DHCP (67/68), SNMP (161) et NTP (123), nécessitant des techniques de scan spécialisées.



### 2 • Outils & Commandes

#### Tableau comparatif des outils de reconnaissance

| Outil | Usage principal | Vitesse | Niveau de bruit | Plateforme |
|-------|----------------|---------|-----------------|------------|
| ping | Test de connectivité | Très rapide | Très faible | Natif Linux |
| arp-scan | Découverte réseau local | Rapide | Faible | Installation requise |
| nmap | Scan de ports polyvalent | Modéré | Configurable | Universel |
| netdiscover | Découverte passive/active | Rapide | Faible à modéré | Installation requise |
| fping | Ping multiple parallèle | Très rapide | Faible | Installation requise |
| masscan | Scan haute vitesse | Très rapide | Élevé | Installation requise |

#### Commandes de base pour la découverte d'hôtes

```shell
# Test de connectivité simple
ping -c 4 192.168.1.1
```
Cette commande envoie 4 paquets ICMP vers l'adresse cible pour vérifier sa disponibilité.

```shell
# Découverte des hôtes actifs sur le réseau local
arp -a
```
Affiche la table ARP locale contenant les correspondances IP/MAC des hôtes récemment contactés.

```shell
# Scan de découverte réseau avec nmap
nmap -sn 192.168.1.0/24
```
Effectue un scan de découverte sans scan de ports sur tout le sous-réseau spécifié.

```shell
# Découverte avec arp-scan (plus discret)
sudo arp-scan -l
```
Scanne le réseau local en utilisant des requêtes ARP, méthode particulièrement efficace sur les réseaux locaux.

#### Commandes pour le scan de ports

```shell
# Scan rapide des ports les plus courants
nmap -T4 -F 192.168.1.100
```
Lance un scan rapide (-F) des 100 ports les plus courants avec un timing agressif (-T4).

```shell
# Scan TCP des ports spécifiques
nmap -p 22,80,443,3389 192.168.1.100
```
Scanne uniquement les ports SSH, HTTP, HTTPS et RDP sur la cible spécifiée.

```shell
# Scan avec détection de version
nmap -sV -p 1-1000 192.168.1.100
```
Effectue un scan avec identification des versions de services sur les 1000 premiers ports.

```shell
# Scan UDP des services courants
sudo nmap -sU -p 53,67,68,69,123,161,162 192.168.1.100
```
Scanne les ports UDP les plus courants nécessitant des privilèges administrateur.

#### Commandes d'analyse réseau avancée

```shell
# Scan avec détection d'OS
sudo nmap -O 192.168.1.100
```
Tente d'identifier le système d'exploitation de la cible en analysant les réponses TCP/IP.

```shell
# Scan avec scripts par défaut
nmap -sC -sV 192.168.1.100
```
Exécute les scripts NSE par défaut tout en détectant les versions de services.

```shell
# Scan furtif SYN
sudo nmap -sS -p 1-1000 192.168.1.100
```
Effectue un scan SYN furtif sans compléter la connexion TCP, réduisant les traces dans les logs.


### 3 • Méthode pas-à-pas

#### Étape 1 : Reconnaissance passive initiale

Avant d'envoyer le moindre paquet vers les cibles, commencez par collecter les informations disponibles localement. Cette approche passive évite toute détection précoce.

```shell
# Vérification de la configuration réseau locale
ip addr show
ip route show
```
Identifiez votre interface réseau active et les routes configurées pour comprendre la topologie locale.

```shell
# Analyse de la table ARP existante
arp -a
cat /proc/net/arp
```
Examinez les entrées ARP pour découvrir les hôtes récemment contactés sur le réseau local.

```shell
# Vérification des connexions actives
netstat -tuln
ss -tuln
```
Listez les services en écoute sur votre système pour comprendre les ports potentiellement intéressants.

#### Étape 2 : Test de connectivité de base

Une fois la reconnaissance passive terminée, procédez à des tests de connectivité simples pour valider la présence des cibles.

```shell
# Test de connectivité vers la passerelle
ping -c 3 $(ip route | grep default | awk '{print $3}')
```
Vérifiez la connectivité vers la passerelle par défaut pour confirmer l'accès réseau.

```shell
# Test de connectivité vers des cibles spécifiques
ping -c 4 192.168.1.1
ping -c 4 8.8.8.8
```
Testez la connectivité vers des adresses locales et externes pour évaluer les restrictions réseau.

```shell
# Test avec différents types de paquets ICMP
ping -c 3 -t 64 192.168.1.1
```
Utilisez différents TTL pour détecter d'éventuels équipements intermédiaires.

#### Étape 3 : Découverte d'hôtes sur le réseau local

Procédez à la découverte systématique des hôtes actifs en utilisant des méthodes progressivement plus intrusives.

```shell
# Découverte passive avec nmap
nmap -sn --disable-arp-ping 192.168.1.0/24
```
Effectuez un scan de découverte en désactivant les requêtes ARP pour une approche plus discrète.

```shell
# Découverte active avec ARP (réseau local uniquement)
sudo nmap -PR 192.168.1.0/24
```
Utilisez les requêtes ARP pour une découverte rapide et fiable sur le réseau local.

```shell
# Découverte avec fping pour les réseaux plus larges
fping -g 192.168.1.0/24 2>/dev/null | grep "is alive"
```
Parallélisez les tests de connectivité pour accélérer la découverte sur de larges plages d'adresses.

#### Étape 4 : Scan de ports ciblé

Une fois les hôtes actifs identifiés, procédez au scan des ports en commençant par les services les plus courants.

```shell
# Scan rapide des ports TCP courants
nmap -T4 -F --top-ports 100 192.168.1.100
```
Scannez les 100 ports les plus courants avec un timing optimisé pour l'efficacité.

```shell
# Scan des ports de services critiques
nmap -p 21,22,23,25,53,80,110,143,443,993,995 192.168.1.100
```
Concentrez-vous sur les ports des services essentiels pour une évaluation rapide.

```shell
# Scan progressif par plages
nmap -p 1-1000 192.168.1.100
nmap -p 1001-5000 192.168.1.100
```
Divisez les scans en plages pour éviter les timeouts et faciliter l'analyse des résultats.

#### Étape 5 : Identification des services

Approfondissez l'analyse des ports ouverts pour identifier les services et leurs versions.

```shell
# Détection de version sur les ports ouverts
nmap -sV -p $(nmap -p- --min-rate=1000 -T4 192.168.1.100 | grep ^[0-9] | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//) 192.168.1.100
```
Combinez découverte de ports et détection de version pour optimiser le temps de scan.

```shell
# Utilisation des scripts NSE de base
nmap -sC -sV -p 80,443 192.168.1.100
```
Exécutez les scripts par défaut pour obtenir des informations supplémentaires sur les services web.

```shell
# Scan UDP des services critiques
sudo nmap -sU --top-ports 20 192.168.1.100
```
N'oubliez pas les services UDP qui peuvent révéler des informations importantes.

#### Étape 6 : Documentation et analyse

Documentez systématiquement vos découvertes pour faciliter les phases ultérieures du test de pénétration.

```shell
# Sauvegarde des résultats en multiple formats
nmap -sV -sC -oA scan_complet_192.168.1.100 192.168.1.100
```
Utilisez l'option -oA pour générer les formats XML, nmap et grepable simultanément.

```shell
# Génération de rapports lisibles
nmap -sV -sC --stylesheet=https://nmap.org/svn/docs/nmap.xsl -oX scan.xml 192.168.1.100
```
Créez des rapports HTML pour faciliter l'analyse et la présentation des résultats.


### 4 • OPSEC Tips

#### 4.1 Gestion du timing et limitation du trafic

La vitesse de scan constitue l'un des indicateurs les plus évidents d'une activité de reconnaissance automatisée. Les systèmes de détection d'intrusion analysent les patterns de connexion pour identifier les scans de ports. Utilisez des délais variables entre les requêtes et limitez le nombre de connexions simultanées pour simuler un comportement humain naturel.

```shell
# Scan avec timing conservateur
nmap -T2 --scan-delay 1s --max-rate 10 192.168.1.100
```

Évitez les scans agressifs (-T4, -T5) en environnement de production et privilégiez les options -T1 ou -T2 pour réduire la signature temporelle. L'option --scan-delay introduit des pauses entre les paquets, tandis que --max-rate limite le débit global.

#### 4.2 Fragmentation et évasion des signatures

Les systèmes de détection analysent les paquets pour identifier les signatures d'outils de scan. La fragmentation des paquets et l'utilisation de techniques d'évasion permettent de contourner ces mécanismes de détection. Cette approche nécessite une compréhension des protocoles réseau mais reste accessible aux débutants.

```shell
# Scan avec fragmentation de paquets
sudo nmap -f -sS 192.168.1.100
```

La fragmentation divise les paquets en segments plus petits, compliquant l'analyse par les IDS. Combinez cette technique avec des adresses sources factices (--spoof-mac) et des ports sources aléatoires (--source-port) pour maximiser l'évasion.

#### 4.3 Surveillance des logs et indicateurs de compromission

Les administrateurs système surveillent activement les logs de connexion pour détecter les activités suspectes. Comprenez quels événements génèrent des entrées dans les logs système (/var/log/auth.log, /var/log/syslog) et adaptez votre stratégie en conséquence. Les connexions SSH échouées, les scans de ports et les requêtes DNS inhabituelles constituent des indicateurs d'alerte.

```shell
# Vérification des logs locaux avant scan
sudo tail -f /var/log/auth.log &
nmap -sS -p 22 192.168.1.100
```

Surveillez vos propres logs pendant les tests pour comprendre les traces laissées par vos outils. Cette approche vous permet d'anticiper les mécanismes de détection et d'ajuster vos techniques pour minimiser la visibilité. Considérez l'utilisation de proxies et de VPN pour masquer votre adresse IP source lors d'engagements autorisés.


### 5 • Lab-Challenge

#### Scénario : Audit de sécurité réseau d'une PME

Vous êtes consultant en cybersécurité mandaté pour effectuer un audit de sécurité du réseau interne d'une petite entreprise. L'administrateur système vous a fourni un accès au réseau local 192.168.100.0/24 depuis un poste de travail Ubuntu. Votre mission consiste à identifier les systèmes actifs, cartographier les services exposés et évaluer la surface d'attaque sans perturber les opérations métier.

L'entreprise dispose d'une infrastructure mixte comprenant des serveurs Linux, des postes Windows, des équipements réseau et potentiellement des dispositifs IoT. L'administrateur souhaite connaître les services accessibles depuis le réseau interne et identifier les éventuelles vulnérabilités de configuration.

#### ⚑ Étape 1 : Découverte et cartographie réseau

**Objectif :** Identifier tous les hôtes actifs sur le réseau 192.168.100.0/24 et déterminer leur rôle probable.

**Questions :**
1. Combien d'hôtes actifs avez-vous découverts sur le réseau ?
2. Quelles sont les adresses IP des 3 premiers hôtes répondant aux requêtes ICMP ?
3. Identifiez l'adresse IP de la passerelle par défaut et confirmez sa disponibilité.
4. Utilisez au moins deux méthodes différentes de découverte d'hôtes et comparez les résultats.

**Contraintes :**
- Utilisez uniquement des outils natifs Linux et nmap
- Documentez chaque commande utilisée et ses résultats
- Limitez le bruit réseau en évitant les scans agressifs

#### ⚑ Étape 2 : Analyse des services et ports

**Objectif :** Identifier les services en cours d'exécution sur les hôtes découverts et déterminer leurs versions.

**Questions :**
1. Quels sont les 5 ports TCP les plus fréquemment ouverts sur le réseau ?
2. Identifiez un serveur web et déterminez sa version exacte (serveur HTTP et version).
3. Localisez un service SSH et tentez d'identifier la version du daemon SSH.
4. Découvrez au moins un service UDP actif et précisez son rôle.

**Contraintes :**
- Concentrez-vous sur les 1000 premiers ports TCP pour chaque hôte
- Utilisez la détection de version pour les services identifiés
- Documentez les bannières de service récupérées

#### ⚑ Étape 3 : Évaluation furtive et reporting

**Objectif :** Effectuer une reconnaissance discrète d'un hôte critique et produire un rapport de synthèse.

**Questions :**
1. Sélectionnez l'hôte avec le plus de services exposés et effectuez un scan furtif complet.
2. Tentez d'identifier le système d'exploitation de cet hôte sans utiliser l'option -O.
3. Recherchez des services non-standard sur des ports élevés (>10000).
4. **Bonus stealth :** Effectuez un scan en utilisant des techniques d'évasion (fragmentation, timing lent).

**Livrables attendus :**
- Rapport de synthèse listant tous les hôtes découverts avec leurs services
- Fichiers de sortie nmap en format XML et grepable
- Recommandations de sécurité basées sur les découvertes
- Documentation des techniques d'évasion utilisées et leur efficacité


### 6 • Going Further

#### Ressources officielles et documentation

**Nmap Official Documentation** - https://nmap.org/book/
La documentation officielle de Nmap constitue la référence absolue pour maîtriser cet outil polyvalent. Elle couvre l'ensemble des options de scan, les scripts NSE et les techniques d'évasion avancées.

**NIST Cybersecurity Framework** - https://www.nist.gov/cyberframework
Le framework NIST fournit les bonnes pratiques pour structurer les activités de cybersécurité, incluant les phases d'identification et de protection essentielles aux tests de pénétration.

**OWASP Testing Guide** - https://owasp.org/www-project-web-security-testing-guide/
Guide complet couvrant les méthodologies de test de sécurité, avec des sections dédiées à la reconnaissance et à l'énumération des services réseau.

#### Ressources d'apprentissage complémentaires

**"The Art of Network Penetration Testing" par Royce Davis**
Livre pratique couvrant les techniques de reconnaissance réseau avec de nombreux exemples concrets et des scénarios réalistes adaptés aux débutants.

**"Network Security Assessment" par Chris McNab**
Ouvrage de référence détaillant les méthodologies d'évaluation de sécurité réseau, des techniques de base aux approches avancées.

**Chaîne YouTube "IppSec"** - https://www.youtube.com/channel/UCa6eh7gCkpPo5XXUDfygQQA
Walkthroughs détaillés de machines HackTheBox avec focus sur les techniques de reconnaissance et d'énumération.

**Cours "Network Security" sur Cybrary** - https://www.cybrary.it/course/network-security/
Formation gratuite couvrant les fondamentaux de la sécurité réseau avec des modules pratiques sur la reconnaissance.

#### Certifications recommandées

**eJPT (eLearnSecurity Junior Penetration Tester)**
Certification d'entrée de gamme idéale pour valider les compétences de base en test de pénétration, incluant la reconnaissance réseau et l'énumération de services.

**PNPT (Practical Network Penetration Tester)**
Certification pratique de TCM Security mettant l'accent sur les compétences réelles de test de pénétration avec des scénarios de reconnaissance réseau authentiques.

**OSCP (Offensive Security Certified Professional)**
Certification avancée nécessitant une maîtrise solide des techniques de reconnaissance pour réussir l'examen pratique de 24 heures.

