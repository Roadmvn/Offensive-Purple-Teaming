# Solution - macOS Recon Beginner Lab

## Étape 1 : Découverte Bonjour

```bash
# Découverte des services Bonjour
dns-sd -B _services._dns-sd._udp local.

# Services Apple spécifiques
dns-sd -B _airplay._tcp local.
dns-sd -B _afpovertcp._tcp local.
dns-sd -B _printer._tcp local.
dns-sd -B _raop._tcp local.

# Résolution détaillée
dns-sd -L "Apple TV Bureau" _airplay._tcp local.
```

**Résultats attendus :**
- 3 Apple TV identifiés : Bureau, Salle-Conf, Studio
- 5 imprimantes AirPrint : Canon MX920, HP LaserJet Pro
- 2 serveurs AFP : MacServer.local, FileServer.local

## Étape 2 : Services de collaboration

```bash
# Test AirDrop (via Bluetooth/WiFi)
system_profiler SPBluetoothDataType | grep "Discoverable"

# Partages AFP
mount_afp afp://guest@MacServer.local/Public /tmp/afp_test

# Services iTunes
dns-sd -B _daap._tcp local.
```

## Étape 3 : Évaluation sécurité

```bash
# Analyse passive mDNS
sudo tcpdump -i en0 -n port 5353 -c 100 | grep -E "_.*\._tcp|_.*\._udp"

# Services non sécurisés
nmap -p 80,548,5353 --script http-title 192.168.1.0/24
```

**Vulnérabilités identifiées :**
- 3 partages AFP avec accès guest
- 2 Apple TV sans code PIN
- 5 services HTTP non chiffrés
- Informations sensibles dans les noms de dispositifs

