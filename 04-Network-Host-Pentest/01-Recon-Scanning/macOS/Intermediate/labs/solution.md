# Solution - macOS Recon Intermediate Lab

## Étape 1 : Cartographie créative

```bash
# Serveurs AFP avancés
nmap --script afp-serverinfo,afp-showmount -p 548 192.168.1.0/24

# Dispositifs AirPlay 4K
dns-sd -B _airplay._tcp local. | grep "4K\|Pro"

# Synchronisation iCloud
netstat -an | grep ":443" | grep "17\." # Apple IP ranges
```

## Étape 2 : Services de production

```bash
# Services de rendu (Final Cut Pro Server, etc.)
nmap -p 3455,49152-49200 192.168.1.0/24

# Stockage réseau
showmount -e 192.168.1.10
mount_nfs 192.168.1.10:/Volumes/Projects /tmp/nfs_test
```

## Étape 3 : Analyse spécialisée

```bash
# Métadonnées de projets
afpfuse 192.168.1.10 /tmp/afp_mount
find /tmp/afp_mount -name "*.fcpx" -o -name "*.prproj"

# Workflows créatifs
tcpdump -i en0 -n port 62078 # AirPlay streaming
```

**Découvertes critiques :**
- 15 projets créatifs exposés sans protection
- 3 serveurs de rendu avec accès non authentifié
- Flux AirPlay 4K non chiffrés
- Métadonnées clients dans les noms de fichiers

